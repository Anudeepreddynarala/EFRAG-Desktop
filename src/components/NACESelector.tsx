import React, { useState, useMemo } from 'react';
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Search, Check } from "lucide-react";
import { Badge } from "@/components/ui/badge";

const naceCodesData = [
  "A - AGRICULTURE, FORESTRY AND FISHING",
  "A - 01 Crop and animal production, hunting and related service activities",
  "A - 01.1 Growing of non-perennial crops",
  "A - 01.11 Growing of cereals, other than rice, leguminous crops and oil seeds",
  "A - 01.12 Growing of rice",
  "A - 01.13 Growing of vegetables and melons, roots and tubers",
  "A - 01.14 Growing of sugar cane",
  "A - 01.15 Growing of tobacco",
  "A - 01.16 Growing of fibre crops",
  "A - 01.19 Growing of other non-perennial crops",
  "A - 01.2 Growing of perennial crops",
  "A - 01.21 Growing of grapes",
  "A - 01.22 Growing of tropical and subtropical fruits",
  "A - 01.23 Growing of citrus fruits",
  "A - 01.24 Growing of pome fruits and stone fruits",
  "A - 01.25 Growing of other tree and bush fruits and nuts",
  "A - 01.26 Growing of oleaginous fruits",
  "A - 01.27 Growing of beverage crops",
  "A - 01.28 Growing of spices, aromatic, drug and pharmaceutical crops",
  "A - 01.29 Growing of other perennial crops",
  "A - 01.3 Plant propagation",
  "A - 01.30 Plant propagation",
  "A - 01.4 Animal production",
  "A - 01.41 Raising of dairy cattle",
  "A - 01.42 Raising of other cattle and buffaloes",
  "A - 01.43 Raising of horses and other equines",
  "A - 01.44 Raising of camels and camelids",
  "A - 01.45 Raising of sheep and goats",
  "A - 01.46 Raising of swine and pigs",
  "A - 01.47 Raising of poultry",
  "A - 01.48 Raising of other animals",
  "A - 01.5 Mixed farming",
  "A - 01.50 Mixed farming",
  "A - 01.6 Support activities to agriculture and post-harvest crop activities",
  "A - 01.61 Support activities for crop production",
  "A - 01.62 Support activities for animal production",
  "A - 01.63 Post-harvest crop activities and seed processing for propagation",
  "A - 01.7 Hunting, trapping and related service activities",
  "A - 01.70 Hunting, trapping and related service activities",
  "A - 02 Forestry and logging",
  "A - 02.1 Silviculture and other forestry activities",
  "A - 02.10 Silviculture and other forestry activities",
  "A - 02.2 Logging",
  "A - 02.20 Logging",
  "A - 02.3 Gathering of wild growing non-wood products",
  "A - 02.30 Gathering of wild growing non-wood products",
  "A - 02.4 Support services to forestry",
  "A - 02.40 Support services to forestry",
  "A - 03 Fishing and aquaculture",
  "A - 03.1 Fishing",
  "A - 03.11 Marine fishing",
  "A - 03.12 Freshwater fishing",
  "A - 03.2 Aquaculture",
  "A - 03.21 Marine aquaculture",
  "A - 03.22 Freshwater aquaculture",
  "A - 03.3 Support activities for fishing and aquaculture",
  "A - 03.30 Support activities for fishing and aquaculture",
  "B - MINING AND QUARRYING",
  "B - 04 Mining of coal and lignite",
  "B - 05.1 Mining of hard coal",
  "B - 05.10 Mining of hard coal",
  "B - 05.2 Mining of lignite",
  "B - 05.20 Mining of lignite",
  "B - 05 Extraction of crude petroleum and natural gas",
  "B - 06.1 Extraction of crude petroleum",
  "B - 06.10 Extraction of crude petroleum",
  "B - 06.2 Extraction of natural gas",
  "B - 06.20 Extraction of natural gas",
  "B - 06 Mining of metal ores",
  "B - 07.1 Mining of iron ores",
  "B - 07.10 Mining of iron ores",
  "B - 07.2 Mining of non-ferrous metal ores",
  "B - 07.21 Mining of uranium and thorium ores",
  "B - 07.29 Mining of other non-ferrous metal ores",
  "B - 07 Other mining and quarrying",
  "B - 08.1 Quarrying of stone, sand and clay",
  "B - 08.11 Quarrying of ornamental stone, limestone, gypsum, slate and other stone",
  "B - 08.12 Operation of gravel and sand pits and mining of clay and kaolin",
  "B - 08.9 Mining and quarrying n.e.c.",
  "B - 08.91 Mining of chemical and fertiliser minerals",
  "B - 08.92 Extraction of peat",
  "B - 08.93 Extraction of salt",
  "B - 08.99 Other mining and quarrying n.e.c.",
  "B - 08 Mining support service activities",
  "B - 09.1 Support activities for petroleum and natural gas extraction",
  "B - 09.10 Support activities for petroleum and natural gas extraction",
  "B - 09.9 Support activities for other mining and quarrying",
  "B - 09.90 Support activities for other mining and quarrying",
  "C - MANUFACTURING",
  "C - 10 Manufacture of food products",
  "C - 10.1 Processing and preserving of meat and production of meat products",
  "C - 10.11 Processing and preserving of meat, except of poultry meat",
  "C - 10.12 Processing and preserving of poultry meat",
  "C - 10.13 Production of meat and poultry meat products",
  "C - 10.2 Processing and preserving of fish, crustaceans and molluscs",
  "C - 10.20 Processing and preserving of fish, crustaceans and molluscs",
  "C - 10.3 Processing and preserving of fruit and vegetables",
  "C - 10.31 Processing and preserving of potatoes",
  "C - 10.32 Manufacture of fruit and vegetable juice",
  "C - 10.39 Other processing and preserving of fruit and vegetables",
  "C - 10.4 Manufacture of vegetable and animal oils and fats",
  "C - 10.41 Manufacture of oils and fats",
  "C - 10.42 Manufacture of margarine and similar edible fats",
  "C - 10.5 Manufacture of dairy products and edible ice",
  "C - 10.51 Manufacture of dairy products",
  "C - 10.52 Manufacture of ice cream and other edible ice",
  "C - 10.6 Manufacture of grain mill products, starches and starch products",
  "C - 10.61 Manufacture of grain mill products",
  "C - 10.62 Manufacture of starches and starch products",
  "C - 10.7 Manufacture of bakery and farinaceous products",
  "C - 10.71 Manufacture of bread; manufacture of fresh pastry goods and cakes",
  "C - 10.72 Manufacture of rusks, biscuits, preserved pastries and cakes",
  "C - 10.73 Manufacture of farinaceous products",
  "C - 10.8 Manufacture of other food products",
  "C - 10.81 Manufacture of sugar",
  "C - 10.82 Manufacture of cocoa, chocolate and sugar confectionery",
  "C - 10.83 Processing of tea and coffee",
  "C - 10.84 Manufacture of condiments and seasonings",
  "C - 10.85 Manufacture of prepared meals and dishes",
  "C - 10.86 Manufacture of homogenised food preparations and dietetic food",
  "C - 10.89 Manufacture of other food products n.e.c.",
  "C - 10.9 Manufacture of prepared animal feeds",
  "C - 10.91 Manufacture of prepared feeds for farm animals",
  "C - 10.92 Manufacture of prepared pet foods",
  "C - 11 Manufacture of beverages",
  "C - 11.0 Manufacture of beverages",
  "C - 11.01 Distilling, rectifying and blending of spirits",
  "C - 11.02 Manufacture of wine from grape",
  "C - 11.03 Manufacture of cider and other fermented fruit beverages",
  "C - 11.04 Manufacture of other non-distilled fermented beverages",
  "C - 11.05 Manufacture of beer",
  "C - 11.06 Manufacture of malt",
  "C - 11.07 Manufacture of soft drinks and bottled waters",
  "C - 12 Manufacture of tobacco products",
  "C - 12.0 Manufacture of tobacco products",
  "C - 12.00 Manufacture of tobacco products",
  "C - 13 Manufacture of textiles",
  "C - 13.1 Preparation and spinning of textile fibres",
  "C - 13.10 Preparation and spinning of textile fibres",
  "C - 13.2 Weaving of textiles",
  "C - 13.20 Weaving of textiles",
  "C - 13.3 Finishing of textiles",
  "C - 13.30 Finishing of textiles",
  "C - 13.9 Manufacture of other textiles",
  "C - 13.91 Manufacture of knitted and crocheted fabrics",
  "C - 13.92 Manufacture of household textiles and made-up furnishing articles",
  "C - 13.93 Manufacture of carpets and rugs",
  "C - 13.94 Manufacture of cordage, rope, twine and netting",
  "C - 13.95 Manufacture of non-wovens and non-woven articles",
  "C - 13.96 Manufacture of other technical and industrial textiles",
  "C - 13.99 Manufacture of other textiles n.e.c.",
  "C - 14 Manufacture of wearing apparel",
  "C - 14.1 Manufacture of knitted and crocheted apparel",
  "C - 14.10 Manufacture of knitted and crocheted apparel",
  "C - 14.2 Manufacture of other wearing apparel and accessories",
  "C - 14.21 Manufacture of outerwear",
  "C - 14.22 Manufacture of underwear",
  "C - 14.23 Manufacture of workwear",
  "C - 14.24 Manufacture of leather clothes and fur apparel",
  "C - 14.29 Manufacture of other wearing apparel and accessories n.e.c.",
  "C - 15 Manufacture of leather and related products of other materials",
  "C - 15.1 Tanning, dyeing, dressing of leather and fur; manufacture of luggage, handbags, saddlery and harness",
  "C - 15.11 Tanning, dressing, dyeing of leather and fur",
  "C - 15.12 Manufacture of luggage, handbags, saddlery and harness of any material",
  "C - 15.2 Manufacture of footwear",
  "C - 15.20 Manufacture of footwear",
  "C - 16 Manufacture of wood and of products of wood and cork, except furniture; manufacture of articles of straw and plaiting materials",
  "C - 16.1 Sawmilling and planing of wood; processing and finishing of wood",
  "C - 16.11 Sawmilling and planing of wood",
  "C - 16.12 Processing and finishing of wood",
  "C - 16.2 Manufacture of products of wood, cork, straw and plaiting materials",
  "C - 16.21 Manufacture of veneer sheets and wood-based panels",
  "C - 16.22 Manufacture of assembled parquet floors",
  "C - 16.23 Manufacture of other builders' carpentry and joinery",
  "C - 16.24 Manufacture of wooden containers",
  "C - 16.25 Manufacture of doors and windows of wood",
  "C - 16.26 Manufacture of solid fuels from vegetable biomass",
  "C - 16.27 Finishing of wooden products",
  "C - 16.28 Manufacture of other products of wood and articles of cork, straw and plaiting materials",
  "C - 17 Manufacture of paper and paper products",
  "C - 17.1 Manufacture of pulp, paper and paperboard",
  "C - 17.11 Manufacture of pulp",
  "C - 17.12 Manufacture of paper and paperboard",
  "C - 17.2 Manufacture of articles of paper and paperboard",
  "C - 17.21 Manufacture of corrugated paper, paperboard and containers of paper and paperboard",
  "C - 17.22 Manufacture of household and sanitary goods and of toilet requisites",
  "C - 17.23 Manufacture of paper stationery",
  "C - 17.24 Manufacture of wallpaper",
  "C - 17.25 Manufacture of other articles of paper and paperboard",
  "C - 18 Printing and reproduction of recorded media",
  "C - 18.1 Printing and service activities related to printing",
  "C - 18.11 Printing of newspapers",
  "C - 18.12 Other printing",
  "C - 18.13 Pre-press and pre-media services",
  "C - 18.14 Binding and related services",
  "C - 18.2 Reproduction of recorded media",
  "C - 18.20 Reproduction of recorded media",
  "C - 19 Manufacture of coke and refined petroleum products",
  "C - 19.1 Manufacture of coke oven products",
  "C - 19.10 Manufacture of coke oven products",
  "C - 19.2 Manufacture of refined petroleum products and fossil fuel products",
  "C - 19.20 Manufacture of refined petroleum products and fossil fuel products",
  "C - 20 Manufacture of chemicals and chemical products",
  "C - 20.1 Manufacture of basic chemicals, fertilisers and nitrogen compounds, plastics and synthetic rubber in primary forms",
  "C - 20.11 Manufacture of industrial gases",
  "C - 20.12 Manufacture of dyes and pigments",
  "C - 20.13 Manufacture of other inorganic basic chemicals",
  "C - 20.14 Manufacture of other organic basic chemicals",
  "C - 20.15 Manufacture of fertilisers and nitrogen compounds",
  "C - 20.16 Manufacture of plastics in primary forms",
  "C - 20.17 Manufacture of synthetic rubber in primary forms",
  "C - 20.2 Manufacture of pesticides, disinfectants and other agrochemical products",
  "C - 20.20 Manufacture of pesticides, disinfectants and other agrochemical products",
  "C - 20.3 Manufacture of paints, varnishes and similar coatings, printing ink and mastics",
  "C - 20.30 Manufacture of paints, varnishes and similar coatings, printing ink and mastics",
  "C - 20.4 Manufacture of washing, cleaning and polishing preparations",
  "C - 20.41 Manufacture of soap and detergents, cleaning and polishing preparations",
  "C - 20.42 Manufacture of perfume and toilet preparations",
  "C - 20.5 Manufacture of other chemical products",
  "C - 20.51 Manufacture of liquid biofuels",
  "C - 20.59 Manufacture of other chemical products n.e.c.",
  "C - 20.6 Manufacture of man-made fibres",
  "C - 20.60 Manufacture of man-made fibres",
  "C - 21 Manufacture of basic pharmaceutical products and pharmaceutical preparations",
  "C - 21.1 Manufacture of basic pharmaceutical products",
  "C - 21.10 Manufacture of basic pharmaceutical products",
  "C - 21.2 Manufacture of pharmaceutical preparations",
  "C - 21.20 Manufacture of pharmaceutical preparations",
  "C - 22 Manufacture of rubber and plastic products",
  "C - 22.1 Manufacture of rubber products",
  "C - 22.11 Manufacture, retreading and rebuilding of rubber tyres and manufacture of tubes",
  "C - 22.12 Manufacture of other rubber products",
  "C - 22.2 Manufacture of plastic products",
  "C - 22.21 Manufacture of plastic plates, sheets, tubes and profiles",
  "C - 22.22 Manufacture of plastic packing goods",
  "C - 22.23 Manufacture of doors and windows of plastic",
  "C - 22.24 Manufacture of builders' ware of plastic",
  "C - 22.25 Processing and finishing of plastic products",
  "C - 22.26 Manufacture of other plastic products",
  "C - 23 Manufacture of other non-metallic mineral products",
  "C - 23.1 Manufacture of glass and glass products",
  "C - 23.11 Manufacture of flat glass",
  "C - 23.12 Shaping and processing of flat glass",
  "C - 23.13 Manufacture of hollow glass",
  "C - 23.14 Manufacture of glass fibres",
  "C - 23.15 Manufacture and processing of other glass, including technical glassware",
  "C - 23.2 Manufacture of refractory products",
  "C - 23.20 Manufacture of refractory products",
  "C - 23.3 Manufacture of clay building materials",
  "C - 23.31 Manufacture of ceramic tiles and flags",
  "C - 23.32 Manufacture of bricks, tiles and construction products, in baked clay",
  "C - 23.4 Manufacture of other porcelain and ceramic products",
  "C - 23.41 Manufacture of ceramic household and ornamental articles",
  "C - 23.42 Manufacture of ceramic sanitary fixtures",
  "C - 23.43 Manufacture of ceramic insulators and insulating fittings",
  "C - 23.44 Manufacture of other technical ceramic products",
  "C - 23.45 Manufacture of other ceramic products",
  "C - 23.5 Manufacture of cement, lime and plaster",
  "C - 23.51 Manufacture of cement",
  "C - 23.52 Manufacture of lime and plaster",
  "C - 23.6 Manufacture of articles of concrete, cement and plaster",
  "C - 23.61 Manufacture of concrete products for construction purposes",
  "C - 23.62 Manufacture of plaster products for construction purposes",
  "C - 23.63 Manufacture of ready-mixed concrete",
  "C - 23.64 Manufacture of mortars",
  "C - 23.65 Manufacture of fibre cement",
  "C - 23.66 Manufacture of other articles of concrete, cement and plaster",
  "C - 23.7 Cutting, shaping and finishing of stone",
  "C - 23.70 Cutting, shaping and finishing of stone",
  "C - 23.9 Manufacture of abrasive products and non-metallic mineral products n.e.c.",
  "C - 23.91 Manufacture of abrasive products",
  "C - 23.99 Manufacture of other non-metallic mineral products n.e.c.",
  "C - 24 Manufacture of basic metals",
  "C - 24.1 Manufacture of basic iron and steel and of ferro-alloys",
  "C - 24.10 Manufacture of basic iron and steel and of ferro-alloys",
  "C - 24.2 Manufacture of tubes, pipes, hollow profiles and related fittings, of steel",
  "C - 24.20 Manufacture of tubes, pipes, hollow profiles and related fittings, of steel",
  "C - 24.3 Manufacture of other products of first processing of steel",
  "C - 24.31 Cold drawing of bars",
  "C - 24.32 Cold rolling of narrow strip",
  "C - 24.33 Cold forming or folding",
  "C - 24.34 Cold drawing of wire",
  "C - 24.4 Manufacture of basic precious and other non-ferrous metals",
  "C - 24.41 Precious metals production",
  "C - 24.42 Aluminium production",
  "C - 24.43 Lead, zinc and tin production",
  "C - 24.44 Copper production",
  "C - 24.45 Other non-ferrous metal production",
  "C - 24.46 Processing of nuclear fuel",
  "C - 24.5 Casting of metals",
  "C - 24.51 Casting of iron",
  "C - 24.52 Casting of steel",
  "C - 24.53 Casting of light metals",
  "C - 24.54 Casting of other non-ferrous metals",
  "C - 25 Manufacture of fabricated metal products, except machinery and equipment",
  "C - 25.1 Manufacture of structural metal products",
  "C - 25.11 Manufacture of metal structures and parts of structures",
  "C - 25.12 Manufacture of doors and windows of metal",
  "C - 25.2 Manufacture of tanks, reservoirs and containers of metal",
  "C - 25.21 Manufacture of central heating radiators, steam generators and boilers",
  "C - 25.22 Manufacture of other tanks, reservoirs and containers of metal",
  "C - 25.3 Manufacture of weapons and ammunition",
  "C - 25.30 Manufacture of weapons and ammunition",
  "C - 25.4 Forging and shaping metal and powder metallurgy",
  "C - 25.40 Forging and shaping metal and powder metallurgy",
  "C - 25.5 Treatment and coating of metals; machining",
  "C - 25.51 Coating of metals",
  "C - 25.52 Heat treatment of metals",
  "C - 25.53 Machining of metals",
  "C - 25.6 Manufacture of cutlery, tools and general hardware",
  "C - 25.61 Manufacture of cutlery",
  "C - 25.62 Manufacture of locks and hinges",
  "C - 25.63 Manufacture of tools",
  "C - 25.9 Manufacture of other fabricated metal products",
  "C - 25.91 Manufacture of steel drums and similar containers",
  "C - 25.92 Manufacture of light metal packaging",
  "C - 25.93 Manufacture of wire products, chain and springs",
  "C - 25.94 Manufacture of fasteners and screw machine products",
  "C - 25.99 Manufacture of other fabricated metal products n.e.c.",
  "C - 26 Manufacture of computer, electronic and optical products",
  "C - 26.1 Manufacture of electronic components and boards",
  "C - 26.11 Manufacture of electronic components",
  "C - 26.12 Manufacture of loaded electronic boards",
  "C - 26.2 Manufacture of computers and peripheral equipment",
  "C - 26.20 Manufacture of computers and peripheral equipment",
  "C - 26.3 Manufacture of communication equipment",
  "C - 26.30 Manufacture of communication equipment",
  "C - 26.4 Manufacture of consumer electronics",
  "C - 26.40 Manufacture of consumer electronics",
  "C - 26.5 Manufacture of measuring testing instruments, clocks and watches",
  "C - 26.51 Manufacture of instruments and appliances for measuring, testing and navigation",
  "C - 26.52 Manufacture of watches and clocks",
  "C - 26.6 Manufacture of irradiation, electromedical and electrotherapeutic equipment",
  "C - 26.60 Manufacture of irradiation, electromedical and electrotherapeutic equipment",
  "C - 26.7 Manufacture of optical instruments, magnetic and optical media and photographic equipment",
  "C - 26.70 Manufacture of optical instruments, magnetic and optical media and photographic equipment",
  "C - 27 Manufacture of electrical equipment",
  "C - 27.1 Manufacture of electric motors, generators, transformers and electricity distribution and control apparatus",
  "C - 27.11 Manufacture of electric motors, generators and transformers",
  "C - 27.12 Manufacture of electricity distribution and control apparatus",
  "C - 27.2 Manufacture of batteries and accumulators",
  "C - 27.20 Manufacture of batteries and accumulators",
  "C - 27.3 Manufacture of wiring and wiring devices",
  "C - 27.31 Manufacture of fibre optic cables",
  "C - 27.32 Manufacture of other electronic and electric wires and cables",
  "C - 27.33 Manufacture of wiring devices",
  "C - 27.4 Manufacture of lighting equipment",
  "C - 27.40 Manufacture of lighting equipment",
  "C - 27.5 Manufacture of domestic appliances",
  "C - 27.51 Manufacture of electric domestic appliances",
  "C - 27.52 Manufacture of non-electric domestic appliances",
  "C - 27.9 Manufacture of other electrical equipment",
  "C - 27.90 Manufacture of other electrical equipment",
  "C - 28 Manufacture of machinery and equipment n.e.c.",
  "C - 28.1 Manufacture of general-purpose machinery",
  "C - 28.11 Manufacture of engines and turbines, except aircraft, vehicle and cycle engines",
  "C - 28.12 Manufacture of fluid power equipment",
  "C - 28.13 Manufacture of other pumps and compressors",
  "C - 28.14 Manufacture of other taps and valves",
  "C - 28.15 Manufacture of bearings, gears, gearing and driving elements",
  "C - 28.2 Manufacture of other general-purpose machinery",
  "C - 28.21 Manufacture of ovens, furnaces and permanent household heating equipment",
  "C - 28.22 Manufacture of lifting and handling equipment",
  "C - 28.23 Manufacture of office machinery and equipment, except computers and peripheral equipment",
  "C - 28.24 Manufacture of power-driven hand tools",
  "C - 28.25 Manufacture of non-domestic air conditioning equipment",
  "C - 28.29 Manufacture of other general-purpose machinery n.e.c.",
  "C - 28.3 Manufacture of agricultural and forestry machinery",
  "C - 28.30 Manufacture of agricultural and forestry machinery",
  "C - 28.4 Manufacture of metal forming machinery and machine tools",
  "C - 28.41 Manufacture of metal forming machinery and machine tools for metal work",
  "C - 28.42 Manufacture of other machine tools",
  "C - 28.9 Manufacture of other special-purpose machinery",
  "C - 28.91 Manufacture of machinery for metallurgy",
  "C - 28.92 Manufacture of machinery for mining, quarrying and construction",
  "C - 28.93 Manufacture of machinery for food, beverage and tobacco processing",
  "C - 28.94 Manufacture of machinery for textile, apparel and leather production",
  "C - 28.95 Manufacture of machinery for paper and paperboard production",
  "C - 28.96 Manufacture of plastics and rubber machinery",
  "C - 28.97 Manufacture of additive manufacturing machinery",
  "C - 28.99 Manufacture of other special-purpose machinery n.e.c.",
  "C - 29 Manufacture of motor vehicles, trailers and semi-trailers",
  "C - 29.1 Manufacture of motor vehicles",
  "C - 29.10 Manufacture of motor vehicles",
  "C - 29.2 Manufacture of bodies and coachwork for motor vehicles; manufacture of trailers and semi-trailers",
  "C - 29.20 Manufacture of bodies and coachwork for motor vehicles; manufacture of trailers and semi-trailers",
  "C - 29.3 Manufacture of motor vehicle parts and accessories",
  "C - 29.31 Manufacture of electrical and electronic equipment for motor vehicles",
  "C - 29.32 Manufacture of other parts and accessories for motor vehicles",
  "C - 30 Manufacture of other transport equipment",
  "C - 30.1 Building of ships and boats",
  "C - 30.11 Building of civilian ships and floating structures",
  "C - 30.12 Building of pleasure and sporting boats",
  "C - 30.13 Building of military ships and vessels",
  "C - 30.2 Manufacture of railway locomotives and rolling stock",
  "C - 30.20 Manufacture of railway locomotives and rolling stock",
  "C - 30.3 Manufacture of air and spacecraft and related machinery",
  "C - 30.31 Manufacture of civilian air and spacecraft and related machinery",
  "C - 30.32 Manufacture of military air and spacecraft and related machinery",
  "C - 30.4 Manufacture of military fighting vehicles",
  "C - 30.40 Manufacture of military fighting vehicles",
  "C - 30.9 Manufacture of transport equipment n.e.c.",
  "C - 30.91 Manufacture of motorcycles",
  "C - 30.92 Manufacture of bicycles and invalid carriages",
  "C - 30.99 Manufacture of other transport equipment n.e.c.",
  "C - 31 Manufacture of furniture",
  "C - 31.0 Manufacture of furniture",
  "C - 31.00 Manufacture of furniture",
  "C - 32 Other manufacturing",
  "C - 32.1 Manufacture of jewellery, bijouterie and related articles",
  "C - 32.11 Striking of coins",
  "C - 32.12 Manufacture of jewellery and related articles",
  "C - 32.13 Manufacture of imitation jewellery and related articles",
  "C - 32.2 Manufacture of musical instruments",
  "C - 32.20 Manufacture of musical instruments",
  "C - 32.3 Manufacture of sports goods",
  "C - 32.30 Manufacture of sports goods",
  "C - 32.4 Manufacture of games and toys",
  "C - 32.40 Manufacture of games and toys",
  "C - 32.5 Manufacture of medical and dental instruments and supplies",
  "C - 32.50 Manufacture of medical and dental instruments and supplies",
  "C - 32.9 Manufacturing n.e.c.",
  "C - 32.91 Manufacture of brooms and brushes",
  "C - 32.99 Other manufacturing n.e.c.",
  "C - 33 Repair, maintenance and installation of machinery and equipment",
  "C - 33.1 Repair and maintenance of fabricated metal products, machinery and equipment",
  "C - 33.11 Repair and maintenance of fabricated metal products",
  "C - 33.12 Repair and maintenance of machinery",
  "C - 33.13 Repair and maintenance of electronic and optical equipment",
  "C - 33.14 Repair and maintenance of electrical equipment",
  "C - 33.15 Repair and maintenance of civilian ships and boats",
  "C - 33.16 Repair and maintenance of civilian air and spacecraft",
  "C - 33.17 Repair and maintenance of other civilian transport equipment",
  "C - 33.18 Repair and maintenance of military fighting vehicles, ships, boats, air and spacecraft",
  "C - 33.19 Repair and maintenance of other equipment",
  "C - 33.2 Installation of industrial machinery and equipment",
  "C - 33.20 Installation of industrial machinery and equipment",
  "D - ELECTRICITY, GAS, STEAM AND AIR CONDITIONING SUPPLY",
  "D - 35 Electricity, gas, steam and air conditioning supply",
  "D - 35.1 Electric power generation, transmission and distribution",
  "D - 35.11 Production of electricity from non-renewable sources",
  "D - 35.12 Production of electricity from renewable sources",
  "D - 35.13 Transmission of electricity",
  "D - 35.14 Distribution of electricity",
  "D - 35.15 Trade of electricity",
  "D - 35.16 Storage of electricity",
  "D - 35.2 Manufacture of gas, and distribution of gaseous fuels through mains",
  "D - 35.21 Manufacture of gas",
  "D - 35.22 Distribution of gaseous fuels through mains",
  "D - 35.23 Trade of gas through mains",
  "D - 35.24 Storage of gas as part of network supply services",
  "D - 35.3 Steam and air conditioning supply",
  "D - 35.30 Steam and air conditioning supply",
  "D - 35.4 Activities of brokers and agents for electric power and natural gas",
  "D - 35.40 Activities of brokers and agents for electric power and natural gas",
  "E - WATER SUPPLY; SEWERAGE, WASTE MANAGEMENT AND REMEDIATION ACTIVITIES",
  "E - 36 Water collection, treatment and supply",
  "E - 36.0 Water collection, treatment and supply",
  "E - 36.00 Water collection, treatment and supply",
  "E - 37 Sewerage",
  "E - 37.0 Sewerage",
  "E - 37.00 Sewerage",
  "E - 38 Waste collection, recovery and disposal activities",
  "E - 38.1 Waste collection",
  "E - 38.11 Collection of non-hazardous waste",
  "E - 38.12 Collection of hazardous waste",
  "E - 38.2 Waste recovery",
  "E - 38.21 Materials recovery",
  "E - 38.22 Energy recovery",
  "E - 38.23 Other waste recovery",
  "E - 38.3 Waste disposal without recovery",
  "E - 38.31 Incineration without energy recovery",
  "E - 38.32 Landfilling or permanent storage",
  "E - 38.33 Other waste disposal",
  "E - 39 Remediation activities and other waste management service activities",
  "E - 39.0 Remediation activities and other waste management service activities",
  "E - 39.00 Remediation activities and other waste management service activities",
  "F - CONSTRUCTION",
  "F - 41 Construction of residential and non-residential buildings",
  "F - 41.0 Construction of residential and non-residential buildings",
  "F - 41.00 Construction of residential and non-residential buildings",
  "F - 42 Civil engineering",
  "F - 42.1 Construction of roads and railways",
  "F - 42.11 Construction of roads and motorways",
  "F - 42.12 Construction of railways and underground railways",
  "F - 42.13 Construction of bridges and tunnels",
  "F - 42.2 Construction of utility projects",
  "F - 42.21 Construction of utility projects for fluids",
  "F - 42.22 Construction of utility projects for electricity and telecommunications",
  "F - 42.9 Construction of other civil engineering projects",
  "F - 42.91 Construction of water projects",
  "F - 42.99 Construction of other civil engineering projects n.e.c.",
  "F - 43 Specialised construction activities",
  "F - 43.1 Demolition and site preparation",
  "F - 43.11 Demolition",
  "F - 43.12 Site preparation",
  "F - 43.13 Test drilling and boring",
  "F - 43.2 Electrical, plumbing and other construction installation activities",
  "F - 43.21 Electrical installation",
  "F - 43.22 Plumbing, heat and air-conditioning installation",
  "F - 43.23 Installation of insulation",
  "F - 43.24 Other construction installation",
  "F - 43.3 Building completion and finishing",
  "F - 43.31 Plastering",
  "F - 43.32 Joinery installation",
  "F - 43.33 Floor and wall covering",
  "F - 43.34 Painting and glazing",
  "F - 43.35 Other building completion and finishing",
  "F - 43.4 Specialised construction activities in construction of buildings",
  "F - 43.41 Roofing activities",
  "F - 43.42 Other specialised construction activities in construction of buildings",
  "F - 43.5 Specialised construction activities in civil engineering",
  "F - 43.50 Specialised construction activities in civil engineering",
  "F - 43.6 Intermediation service activities for specialised construction services",
  "F - 43.60 Intermediation service activities for specialised construction services",
  "F - 43.9 Other specialised construction activities",
  "F - 43.91 Masonry and bricklaying activities",
  "F - 43.99 Other specialised construction activities n.e.c.",
  "G - WHOLESALE AND RETAIL TRADE",
  "G - 46 Wholesale trade",
  "G - 46.1 Wholesale on a fee or contract basis",
  "G - 46.11 Activities of agents involved in the wholesale of agricultural raw materials, live animals, textile raw materials and semi-finished goods",
  "G - 46.12 Activities of agents involved in the wholesale of fuels, ores, metals and industrial chemicals",
  "G - 46.13 Activities of agents involved in the wholesale of timber and building materials",
  "G - 46.14 Activities of agents involved in the wholesale of machinery, industrial equipment, ships and aircraft",
  "G - 46.15 Activities of agents involved in the wholesale of furniture, household goods, hardware and ironmongery",
  "G - 46.16 Activities of agents involved in the wholesale of textiles, clothing, fur, footwear and leather goods",
  "G - 46.17 Activities of agents involved in the wholesale of food, beverages and tobacco",
  "G - 46.18 Activities of agents involved in the wholesale of other particular products",
  "G - 46.19 Activities of agents involved in non-specialised wholesale",
  "G - 46.2 Wholesale of agricultural raw materials and live animals",
  "G - 46.21 Wholesale of grain, unmanufactured tobacco, seeds and animal feeds",
  "G - 46.22 Wholesale of flowers and plants",
  "G - 46.23 Wholesale of live animals",
  "G - 46.24 Wholesale of hides, skins and leather",
  "G - 46.3 Wholesale of food, beverages and tobacco",
  "G - 46.31 Wholesale of fruit and vegetables",
  "G - 46.32 Wholesale of meat, meat products, fish and fish products",
  "G - 46.33 Wholesale of dairy products, eggs and edible oils and fats",
  "G - 46.34 Wholesale of beverages",
  "G - 46.35 Wholesale of tobacco products",
  "G - 46.36 Wholesale of sugar, chocolate and sugar confectionery",
  "G - 46.37 Wholesale of coffee, tea, cocoa and spices",
  "G - 46.38 Wholesale of other food",
  "G - 46.39 Non-specialised wholesale of food, beverages and tobacco",
  "G - 46.4 Wholesale of household goods",
  "G - 46.41 Wholesale of textiles",
  "G - 46.42 Wholesale of clothing and footwear",
  "G - 46.43 Wholesale of electrical household appliances",
  "G - 46.44 Wholesale of china and glassware and cleaning materials",
  "G - 46.45 Wholesale of perfume and cosmetics",
  "G - 46.46 Wholesale of pharmaceutical and medical goods",
  "G - 46.47 Wholesale of household, office and shop furniture, carpets and lighting equipment",
  "G - 46.48 Wholesale of watches and jewellery",
  "G - 46.49 Wholesale of other household goods",
  "G - 46.5 Wholesale of information and communication equipment",
  "G - 46.50 Wholesale of information and communication equipment",
  "G - 46.6 Wholesale of other machinery, equipment and supplies",
  "G - 46.61 Wholesale of agricultural machinery, equipment and supplies",
  "G - 46.62 Wholesale of machine tools",
  "G - 46.63 Wholesale of mining, construction and civil engineering machinery",
  "G - 46.64 Wholesale of other machinery and equipment",
  "G - 46.7 Wholesale of motor vehicles, motorcycles and related parts and accessories",
  "G - 46.71 Wholesale of motor vehicles",
  "G - 46.72 Wholesale of motor vehicle parts and accessories",
  "G - 46.73 Wholesale of motorcycles, motorcycle parts and accessories",
  "G - 46.8 Other specialised wholesale",
  "G - 46.81 Wholesale of solid, liquid and gaseous fuels and related products",
  "G - 46.82 Wholesale of metals and metal ores",
  "G - 46.83 Wholesale of wood, construction materials and sanitary equipment",
  "G - 46.84 Wholesale of hardware, plumbing and heating equipment and supplies",
  "G - 46.85 Wholesale of chemical products",
  "G - 46.86 Wholesale of other intermediate products",
  "G - 46.87 Wholesale of waste and scrap",
  "G - 46.89 Other specialised wholesale n.e.c.",
  "G - 46.9 Non-specialised wholesale trade",
  "G - 46.90 Non-specialised wholesale trade",
  "G - 47 Retail trade",
  "G - 47.1 Non-specialised retail sale",
  "G - 47.11 Non-specialised retail sale of predominately food, beverages or tobacco",
  "G - 47.12 Other non-specialised retail sale",
  "G - 47.2 Retail sale of food, beverages and tobacco",
  "G - 47.21 Retail sale of fruit and vegetables",
  "G - 47.22 Retail sale of meat and meat products",
  "G - 47.23 Retail sale of fish, crustaceans and molluscs",
  "G - 47.24 Retail sale of bread, cake and confectionery",
  "G - 47.25 Retail sale of beverages",
  "G - 47.26 Retail sale of tobacco products",
  "G - 47.27 Retail sale of other food",
  "G - 47.3 Retail sale of automotive fuel",
  "G - 47.30 Retail sale of automotive fuel",
  "G - 47.4 Retail sale of information and communication equipment",
  "G - 47.40 Retail sale of information and communication equipment",
  "G - 47.5 Retail sale of other household equipment",
  "G - 47.51 Retail sale of textiles",
  "G - 47.52 Retail sale of hardware, building materials, paints and glass",
  "G - 47.53 Retail sale of carpets, rugs, wall and floor coverings",
  "G - 47.54 Retail sale of electrical household appliances",
  "G - 47.55 Retail sale of furniture, lighting equipment, tableware and other household goods",
  "G - 47.6 Retail sale of cultural and recreation goods",
  "G - 47.61 Retail sale of books",
  "G - 47.62 Retail sale of newspapers, and other periodical publications and stationery",
  "G - 47.63 Retail sale of sporting equipment",
  "G - 47.64 Retail sale of games and toys",
  "G - 47.69 Retail sale of cultural and recreational goods n.e.c.",
  "G - 47.7 Retail sale of other goods, except motor vehicles and motorcycles",
  "G - 47.71 Retail sale of clothing",
  "G - 47.72 Retail sale of footwear and leather goods",
  "G - 47.73 Retail sale of pharmaceutical products",
  "G - 47.74 Retail sale of medical and orthopaedic goods",
  "G - 47.75 Retail sale of cosmetic and toilet articles",
  "G - 47.76 Retail sale of flowers, plants, fertilisers, pets and pet food",
  "G - 47.77 Retail sale of watches and jewellery",
  "G - 47.78 Retail sale of other new goods",
  "G - 47.79 Retail sale of second-hand goods",
  "G - 47.8 Retail sale of motor vehicles, motorcycles and related parts and accessories",
  "G - 47.81 Retail sale of motor vehicles",
  "G - 47.82 Retail sale of motor vehicle parts and accessories",
  "G - 47.83 Retail sale of motorcycles, motorcycle parts and accessories",
  "G - 47.9 Intermediation service activities for retail sale",
  "G - 47.91 Intermediation service activities for non-specialised retail sale",
  "G - 47.92 Intermediation service activities for specialised retail sale",
  "H - TRANSPORTATION AND STORAGE",
  "H - 49 Land transport and transport via pipelines",
  "H - 49.1 Passenger rail transport",
  "H - 49.11 Passenger heavy rail transport",
  "H - 49.12 Other passenger rail transport",
  "H - 49.2 Freight rail transport",
  "H - 49.20 Freight rail transport",
  "H - 49.3 Other passenger land transport",
  "H - 49.31 Scheduled passenger transport by road",
  "H - 49.32 Non-scheduled passenger transport by road",
  "H - 49.33 On-demand passenger transport service activities by vehicle with driver",
  "H - 49.34 Passenger transport by cableways and ski lifts",
  "H - 49.39 Other passenger land transport n.e.c.",
  "H - 49.4 Freight transport by road and removal services",
  "H - 49.41 Freight transport by road",
  "H - 49.42 Removal services",
  "H - 49.5 Transport via pipeline",
  "H - 49.50 Transport via pipeline",
  "H - 50 Water transport",
  "H - 50.1 Sea and coastal passenger water transport",
  "H - 50.10 Sea and coastal passenger water transport",
  "H - 50.2 Sea and coastal freight water transport",
  "H - 50.20 Sea and coastal freight water transport",
  "H - 50.3 Inland passenger water transport",
  "H - 50.30 Inland passenger water transport",
  "H - 50.4 Inland freight water transport",
  "H - 50.40 Inland freight water transport",
  "H - 51 Air transport",
  "H - 51.1 Passenger air transport",
  "H - 51.10 Passenger air transport",
  "H - 51.2 Freight air transport and space transport",
  "H - 51.21 Freight air transport",
  "H - 51.22 Space transport",
  "H - 52 Warehousing, storage and support activities for transportation",
  "H - 52.1 Warehousing and storage",
  "H - 52.10 Warehousing and storage",
  "H - 52.2 Support activities for transportation",
  "H - 52.21 Service activities incidental to land transportation",
  "H - 52.22 Service activities incidental to water transportation",
  "H - 52.23 Service activities incidental to air transportation",
  "H - 52.24 Cargo handling",
  "H - 52.25 Logistics service activities",
  "H - 52.26 Other support activities for transportation",
  "H - 52.3 Intermediation service activities for transportation",
  "H - 52.31 Intermediation service activities for freight transportation",
  "H - 52.32 Intermediation service activities for passenger transportation",
  "H - 53 Postal and courier activities",
  "H - 53.1 Postal activities under universal service obligation",
  "H - 53.10 Postal activities under universal service obligation",
  "H - 53.2 Other postal and courier activities",
  "H - 53.20 Other postal and courier activities",
  "H - 53.3 Intermediation service activities for postal and courier activities",
  "H - 53.30 Intermediation service activities for postal and courier activities",
  "I - ACCOMMODATION AND FOOD SERVICE ACTIVITIES",
  "I - 55 Accommodation",
  "I - 55.1 Hotels and similar accommodation",
  "I - 55.10 Hotels and similar accommodation",
  "I - 55.2 Holiday and other short-stay accommodation",
  "I - 55.20 Holiday and other short-stay accommodation",
  "I - 55.3 Camping grounds and recreational vehicle parks",
  "I - 55.30 Camping grounds and recreational vehicle parks",
  "I - 55.4 Intermediation service activities for accommodation",
  "I - 55.40 Intermediation service activities for accommodation",
  "I - 55.9 Other accommodation",
  "I - 55.90 Other accommodation",
  "I - 56 Food and beverage service activities",
  "I - 56.1 Restaurants and mobile food service activities",
  "I - 56.11 Restaurant activities",
  "I - 56.12 Mobile food service activities",
  "I - 56.2 Event catering, contract catering service activities and other food service activities",
  "I - 56.21 Event catering activities",
  "I - 56.22 Contract catering service activities and other food service activities",
  "I - 56.3 Beverage serving activities",
  "I - 56.30 Beverage serving activities",
  "I - 56.4 Intermediation service activities for food and beverage services activities",
  "I - 56.40 Intermediation service activities for food and beverage services activities",
  "J - PUBLISHING, BROADCASTING, AND CONTENT PRODUCTION AND DISTRIBUTION ACTIVITIES",
  "J - 58 Publishing activities",
  "J - 58.1 Publishing of books, newspapers and other publishing activities, except software publishing",
  "J - 58.11 Publishing of books",
  "J - 58.12 Publishing of newspapers",
  "J - 58.13 Publishing of journals and periodicals",
  "J - 58.19 Other publishing activities, except software publishing",
  "J - 58.2 Software publishing",
  "J - 58.21 Publishing of video games",
  "J - 58.29 Other software publishing",
  "J - 59 Motion picture, video and television programme production, sound recording and music publishing activities",
  "J - 59.1 Motion picture, video and television programme activities",
  "J - 59.11 Motion picture, video and television programme production activities",
  "J - 59.12 Motion picture, video and television programme post-production activities",
  "J - 59.13 Motion picture and video distribution activities",
  "J - 59.14 Motion picture projection activities",
  "J - 59.2 Sound recording and music publishing activities",
  "J - 59.20 Sound recording and music publishing activities",
  "J - 60 Programming, broadcasting, news agency and other content distribution activities",
  "J - 60.1 Radio broadcasting and audio distribution activities",
  "J - 60.10 Radio broadcasting and audio distribution activities",
  "J - 60.2 Television programming, broadcasting and video distribution activities",
  "J - 60.20 Television programming, broadcasting and video distribution activities",
  "J - 60.3 News agency and other content distribution activities",
  "J - 60.31 News agency activities",
  "J - 60.39 Other content distribution activities",
  "K - TELECOMMUNICATION, COMPUTER PROGRAMMING, CONSULTING, COMPUTING INFRASTRUCTURE AND OTHER INFORMATION SERVICE ACTIVITIES",
  "K - 61 Telecommunication",
  "K - 61.1 Wired, wireless, and satellite telecommunication activities",
  "K - 61.10 Wired, wireless, and satellite telecommunication activities",
  "K - 61.2 Telecommunication reselling activities and intermediation service activities for telecommunication",
  "K - 61.20 Telecommunication reselling activities and intermediation service activities for telecommunication",
  "K - 61.9 Other telecommunication activities",
  "K - 61.90 Other telecommunication activities",
  "K - 62 Computer programming, consultancy and related activities",
  "K - 62.1 Computer programming activities",
  "K - 62.10 Computer programming activities",
  "K - 62.2 Computer consultancy and computer facilities management activities",
  "K - 62.20 Computer consultancy and computer facilities management activities",
  "K - 62.9 Other information technology and computer service activities",
  "K - 62.90 Other information technology and computer service activities",
  "K - 63 Computing infrastructure, data processing, hosting and other information service activities",
  "K - 63.1 Computing infrastructure, data processing, hosting and related activities",
  "K - 63.10 Computing infrastructure, data processing, hosting and related activities",
  "K - 63.9 Web search portal activities and other information service activities",
  "K - 63.91 Web search portal activities",
  "K - 63.92 Other information service activities",
  "L - FINANCIAL AND INSURANCE ACTIVITIES",
  "L - 64 Financial service activities, except insurance and pension funding",
  "L - 64.1 Monetary intermediation",
  "L - 64.11 Central banking",
  "L - 64.19 Other monetary intermediation",
  "L - 64.2 Activities of holding companies and financing conduits",
  "L - 64.21 Activities of holding companies",
  "L - 64.22 Activities of financing conduits",
  "L - 64.3 Activities of trusts, funds and similar financial entities",
  "L - 64.31 Activities of money market and non-money market investments funds",
  "L - 64.32 Activities of trust, estate and agency accounts",
  "L - 64.9 Other financial service activities, except insurance and pension funding",
  "L - 64.91 Financial leasing",
  "L - 64.92 Other credit granting",
  "L - 64.99 Other financial service activities, except insurance and pension funding n.e.c.",
  "L - 65 Insurance, reinsurance and pension funding, except compulsory social security",
  "L - 65.1 Insurance",
  "L - 65.11 Life insurance",
  "L - 65.12 Non-life insurance",
  "L - 65.2 Reinsurance",
  "L - 65.20 Reinsurance",
  "L - 65.3 Pension funding",
  "L - 65.30 Pension funding",
  "L - 66 Activities auxiliary to financial services and insurance activities",
  "L - 66.1 Activities auxiliary to financial services, except insurance and pension funding",
  "L - 66.11 Administration of financial markets",
  "L - 66.12 Security and commodity contracts brokerage",
  "L - 66.19 Other activities auxiliary to financial services, except insurance and pension funding",
  "L - 66.2 Activities auxiliary to insurance and pension funding",
  "L - 66.21 Risk and damage evaluation",
  "L - 66.22 Activities of insurance agents and brokers",
  "L - 66.29 Activities auxiliary to insurance and pension funding n.e.c.",
  "L - 66.3 Fund management activities",
  "L - 66.30 Fund management activities",
  "M - REAL ESTATE ACTIVITIES",
  "M - 68 Real estate activities",
  "M - 68.1 Real estate activities with own property and development of building projects",
  "M - 68.11 Buying and selling of own real estate",
  "M - 68.12 Development of building projects",
  "M - 68.2 Rental and operating of own or leased real estate",
  "M - 68.20 Rental and operating of own or leased real estate",
  "M - 68.3 Real estate activities on a fee or contract basis",
  "M - 68.31 Intermediation service activities for real estate activities",
  "M - 68.32 Other real estate activities on a fee or contract basis",
  "N - PROFESSIONAL, SCIENTIFIC AND TECHNICAL ACTIVITIES",
  "N - 69 Legal and accounting activities",
  "N - 69.1 Legal activities",
  "N - 69.10 Legal activities",
  "N - 69.2 Accounting, bookkeeping and auditing activities; tax consultancy",
  "N - 69.20 Accounting, bookkeeping and auditing activities; tax consultancy",
  "N - 70 Activities of head offices and management consultancy",
  "N - 70.1 Activities of head offices",
  "N - 70.10 Activities of head offices",
  "N - 70.2 Business and other management consultancy activities",
  "N - 70.20 Business and other management consultancy activities",
  "N - 71 Architectural and engineering activities; technical testing and analysis",
  "N - 71.1 Architectural and engineering activities and related technical consultancy",
  "N - 71.11 Architectural activities",
  "N - 71.12 Engineering activities and related technical consultancy",
  "N - 71.2 Technical testing and analysis",
  "N - 71.20 Technical testing and analysis",
  "N - 72 Scientific research and development",
  "N - 72.1 Research and experimental development on natural sciences and engineering",
  "N - 72.10 Research and experimental development on natural sciences and engineering",
  "N - 72.2 Research and experimental development on social sciences and humanities",
  "N - 72.20 Research and experimental development on social sciences and humanities",
  "N - 73 Activities of advertising, market research and public relations",
  "N - 73.1 Advertising",
  "N - 73.11 Activities of advertising agencies",
  "N - 73.12 Media representation",
  "N - 73.2 Market research and public opinion polling",
  "N - 73.20 Market research and public opinion polling",
  "N - 73.3 Public relations and communication activities",
  "N - 73.30 Public relations and communication activities",
  "N - 74 Other professional, scientific and technical activities",
  "N - 74.1 Specialised design activities",
  "N - 74.11 Industrial product and fashion design activities",
  "N - 74.12 Graphic design and visual communication activities",
  "N - 74.13 Interior design activities",
  "N - 74.14 Other specialised design activities",
  "N - 74.2 Photographic activities",
  "N - 74.20 Photographic activities",
  "N - 74.3 Translation and interpretation activities",
  "N - 74.30 Translation and interpretation activities",
  "N - 74.9 Other professional, scientific and technical activities n.e.c.",
  "N - 74.91 Patent brokering and marketing service activities",
  "N - 74.99 All other professional, scientific and technical activities n.e.c.",
  "N - 75 Veterinary activities",
  "N - 75.0 Veterinary activities",
  "N - 75.00 Veterinary activities",
  "O - ADMINISTRATIVE AND SUPPORT SERVICE ACTIVITIES",
  "O - 77 Rental and leasing activities",
  "O - 77.1 Rental and leasing of motor vehicles",
  "O - 77.11 Rental and leasing of cars and light motor vehicles",
  "O - 77.12 Rental and leasing of trucks",
  "O - 77.2 Rental and leasing of personal and household goods",
  "O - 77.21 Rental and leasing of recreational and sports goods",
  "O - 77.22 Rental and leasing of other personal and household goods",
  "O - 77.3 Rental and leasing of other machinery, equipment and tangible goods",
  "O - 77.31 Rental and leasing of agricultural machinery and equipment",
  "O - 77.32 Rental and leasing of construction and civil engineering machinery and equipment",
  "O - 77.33 Rental and leasing of office machinery, equipment and computers",
  "O - 77.34 Rental and leasing of water transport equipment",
  "O - 77.35 Rental and leasing of air transport equipment",
  "O - 77.39 Rental and leasing of other machinery, equipment and tangible goods n.e.c.",
  "O - 77.4 Leasing of intellectual property and similar products, except copyrighted works",
  "O - 77.40 Leasing of intellectual property and similar products, except copyrighted works",
  "O - 77.5 Intermediation service activities for rental and leasing of tangible goods and non-financial intangible assets",
  "O - 77.51 Intermediation service activities for rental and leasing of cars, motorhomes and trailers",
  "O - 77.52 Intermediation service activities for rental and leasing of other tangible goods and non-financial intangible assets",
  "O - 78 Employment activities",
  "O - 78.1 Activities of employment placement agencies",
  "O - 78.10 Activities of employment placement agencies",
  "O - 78.2 Temporary employment agency activities and other human resource provisions",
  "O - 78.20 Temporary employment agency activities and other human resource provisions",
  "O - 79 Travel agency, tour operator and other reservation service and related activities",
  "O - 79.1 Travel agency and tour operator activities",
  "O - 79.11 Travel agency activities",
  "O - 79.12 Tour operator activities",
  "O - 79.9 Other reservation service and related activities",
  "O - 79.90 Other reservation service and related activities",
  "O - 80 Investigation and security activities",
  "O - 80.0 Investigation and security activities",
  "O - 80.01 Investigation and private security activities",
  "O - 80.09 Security activities n.e.c.",
  "O - 81 Services to buildings and landscape activities",
  "O - 81.1 Combined facilities support activities",
  "O - 81.10 Combined facilities support activities",
  "O - 81.2 Cleaning activities",
  "O - 81.21 General cleaning of buildings",
  "O - 81.22 Other building and industrial cleaning activities",
  "O - 81.23 Other cleaning activities",
  "O - 81.3 Landscape service activities",
  "O - 81.30 Landscape service activities",
  "O - 82 Office administrative, office support and other business support activities",
  "O - 82.1 Office administrative and support activities",
  "O - 82.10 Office administrative and support activities",
  "O - 82.2 Activities of call centres",
  "O - 82.20 Activities of call centres",
  "O - 82.3 Organisation of conventions and trade shows",
  "O - 82.30 Organisation of conventions and trade shows",
  "O - 82.4 Intermediation service activities for business support service activities n.e.c.",
  "O - 82.40 Intermediation service activities for business support service activities n.e.c.",
  "O - 82.9 Business support service activities n.e.c.",
  "O - 82.91 Activities of collection agencies and credit bureaus",
  "O - 82.92 Packaging activities",
  "O - 82.99 Other business support service activities n.e.c.",
  "P - PUBLIC ADMINISTRATION AND DEFENCE; COMPULSORY SOCIAL SECURITY",
  "P - 84 Public administration and defence; compulsory social security",
  "P - 84.1 Administration of the State and the economic, social and environmental policies of the community",
  "P - 84.11 General public administration activities",
  "P - 84.12 Regulation of health care, education, cultural services and other social services",
  "P - 84.13 Regulation of and contribution to more efficient operation of businesses",
  "P - 84.2 Provision of services to the community as a whole",
  "P - 84.21 Foreign affairs",
  "P - 84.22 Defence activities",
  "P - 84.23 Justice and judicial activities",
  "P - 84.24 Public order and safety activities",
  "P - 84.25 Fire service activities",
  "P - 84.3 Compulsory social security activities",
  "P - 84.30 Compulsory social security activities",
  "Q - EDUCATION",
  "Q - 85 Education",
  "Q - 85.1 Pre-primary education",
  "Q - 85.10 Pre-primary education",
  "Q - 85.2 Primary education",
  "Q - 85.20 Primary education",
  "Q - 85.3 Secondary and post-secondary non-tertiary education",
  "Q - 85.31 General secondary education",
  "Q - 85.32 Vocational secondary education",
  "Q - 85.33 Post-secondary non-tertiary education",
  "Q - 85.4 Tertiary education",
  "Q - 85.40 Tertiary education",
  "Q - 85.5 Other education",
  "Q - 85.51 Sports and recreation education",
  "Q - 85.52 Cultural education",
  "Q - 85.53 Driving school activities",
  "Q - 85.59 Other education n.e.c.",
  "Q - 85.6 Educational support activities",
  "Q - 85.61 Intermediation service activities for courses and tutors",
  "Q - 85.69 Educational support activities n.e.c.",
  "R - HUMAN HEALTH AND SOCIAL WORK ACTIVITIES",
  "R - 86 Human health activities",
  "R - 86.1 Hospital activities",
  "R - 86.10 Hospital activities",
  "R - 86.2 Medical and dental practice activities",
  "R - 86.21 General medical practice activities",
  "R - 86.22 Medical specialists activities",
  "R - 86.23 Dental practice care activities",
  "R - 86.9 Other human health activities",
  "R - 86.91 Diagnostic imaging services and medical laboratory activities",
  "R - 86.92 Patient transportation by ambulance",
  "R - 87 Residential care activities",
  "R - 87.1 Residential nursing care activities",
  "R - 87.10 Residential nursing care activities",
  "R - 87.2 Residential care activities for persons living with or having a diagnosis of a mental illness or substance abuse",
  "R - 87.20 Residential care activities for persons living with or having a diagnosis of a mental illness or substance abuse",
  "R - 87.3 Residential care activities for older persons or persons with physical disabilities",
  "R - 87.30 Residential care activities for older persons or persons with physical disabilities",
  "R - 87.9 Other residential care activities",
  "R - 87.91 Intermediation service activities for residential care activities",
  "R - 87.99 Other residential care activities n.e.c.",
  "R - 88 Social work activities without accommodation",
  "R - 88.1 Social work activities without accommodation for older persons or persons with disabilities",
  "R - 88.10 Social work activities without accommodation for older persons or persons with disabilities",
  "R - 88.9 Other social work activities without accommodation",
  "R - 88.91 Child day-care activities",
  "R - 88.99 Other social work activities without accommodation n.e.c.",
  "S - ARTS, SPORTS AND RECREATION",
  "S - 90 Arts creation and performing arts activities",
  "S - 90.1 Arts creation activities",
  "S - 90.11 Literary creation and musical composition activities",
  "S - 90.12 Visual arts creation activities",
  "S - 90.13 Other arts creation activities",
  "S - 90.2 Activities of performing arts",
  "S - 90.20 Activities of performing arts",
  "S - 90.3 Support activities to arts creation and performing arts",
  "S - 90.31 Operation of arts facilities and sites",
  "S - 90.39 Other support activities to arts and performing arts",
  "S - 91 Libraries, archives, museums and other cultural activities",
  "S - 91.1 Library and archive activities",
  "S - 91.11 Library activities",
  "S - 91.12 Archive activities",
  "S - 91.2 Museum, collection, historical site and monument activities",
  "S - 91.21 Museum and collection activities",
  "S - 91.22 Historical site and monument activities",
  "S - 91.3 Conservation, restoration and other support activities for cultural heritage",
  "S - 91.30 Conservation, restoration and other support activities for cultural heritage",
  "S - 91.4 Botanical and zoological garden and nature reserve activities",
  "S - 91.41 Botanical and zoological garden activities",
  "S - 91.42 Nature reserve activities",
  "S - 92 Gambling and betting activities",
  "S - 92.0 Gambling and betting activities",
  "S - 92.00 Gambling and betting activities",
  "S - 93 Sports activities and amusement and recreation activities",
  "S - 93.1 Sports activities",
  "S - 93.11 Operation of sports facilities",
  "S - 93.12 Activities of sports clubs",
  "S - 93.13 Activities of fitness centres",
  "S - 93.19 Sports activities n.e.c.",
  "S - 93.2 Amusement and recreation activities",
  "S - 93.21 Activities of amusement parks and theme parks",
  "S - 93.29 Amusement and recreation activities n.e.c.",
  "T - OTHER SERVICE ACTIVITIES",
  "T - 94 Activities of membership organisations",
  "T - 94.1 Activities of business, employers and professional membership organisations",
  "T - 94.11 Activities of business and employers membership organisations",
  "T - 94.12 Activities of professional membership organisations",
  "T - 94.2 Activities of trade unions",
  "T - 94.20 Activities of trade unions",
  "T - 94.9 Activities of other membership organisations",
  "T - 94.91 Activities of religious organisations",
  "T - 94.92 Activities of political organisations",
  "T - 94.99 Activities of other membership organisations n.e.c.",
  "T - 95 Repair and maintenance of computers, personal and household goods, and motor vehicles and motorcycles",
  "T - 95.1 Repair and maintenance of computers and communication equipment",
  "T - 95.10 Repair and maintenance of computers and communication equipment",
  "T - 95.2 Repair and maintenance of personal and household goods",
  "T - 95.21 Repair and maintenance of consumer electronics",
  "T - 95.22 Repair and maintenance of household appliances and home and garden equipment",
  "T - 95.23 Repair and maintenance of footwear and leather goods",
  "T - 95.24 Repair and maintenance of furniture and home furnishings",
  "T - 95.25 Repair and maintenance of watches, clocks and jewellery",
  "T - 95.29 Repair and maintenance of personal and household goods n.e.c.",
  "T - 95.3 Repair and maintenance of motor vehicles and motorcycles",
  "T - 95.31 Repair and maintenance of motor vehicles",
  "T - 95.32 Repair and maintenance of motorcycles",
  "T - 95.4 Intermediation service activities for repair and maintenance of computers, personal and household goods, and motor vehicles and motorcycles",
  "T - 95.40 Intermediation service activities for repair and maintenance of computers, personal and household goods, and motor vehicles and motorcycles",
  "T - 96 Personal service activities",
  "T - 96.1 Washing and cleaning of textile and fur products",
  "T - 96.10 Washing and cleaning of textile and fur products",
  "T - 96.2 Hairdressing, beauty treatment, day spa and similar activities",
  "T - 96.21 Hairdressing and barber activities",
  "T - 96.22 Beauty care and other beauty treatment activities",
  "T - 96.23 Day spa, sauna and steam bath activities",
  "T - 96.3 Funeral and related activities",
  "T - 96.30 Funeral and related activities",
  "T - 96.4 Intermediation service activities for personal services",
  "T - 96.40 Intermediation service activities for personal services",
  "T - 96.9 Other personal service activities",
  "T - 96.91 Provision of domestic personal service activities",
  "T - 96.99 Other personal service activities n.e.c.",
  "U - ACTIVITIES OF HOUSEHOLDS AS EMPLOYERS AND UNDIFFERENTIATED GOODS  AND SERVICE-PRODUCING ACTIVITIES OF HOUSEHOLDS FOR OWN USE",
  "U - 97 Activities of households as employers of domestic personnel",
  "U - 97.0 Activities of households as employers of domestic personnel",
  "U - 97.00 Activities of households as employers of domestic personnel",
  "U - 98 Undifferentiated goods- and service-producing activities of private households for own use",
  "U - 98.1 Undifferentiated goods-producing activities of private households for own use",
  "U - 98.10 Undifferentiated goods-producing activities of private households for own use",
  "U - 98.2 Undifferentiated service-producing activities of private households for own use",
  "U - 98.20 Undifferentiated service-producing activities of private households for own use",
  "V - ACTIVITIES OF EXTRATERRITORIAL ORGANISATIONS AND BODIES",
  "V - 99 Activities of extraterritorial organisations and bodies",
  "V - 99.0 Activities of extraterritorial organisations and bodies",
  "V - 99.00 Activities of extraterritorial organisations and bodies"
];

interface NACESelectorProps {
  selectedValues: string[];
  onSelectionChange: (values: string[]) => void;
  disabled?: boolean;
}

export const NACESelector: React.FC<NACESelectorProps> = ({
  selectedValues,
  onSelectionChange,
  disabled = false
}) => {
  const [open, setOpen] = useState(false);
  const [searchTerm, setSearchTerm] = useState("");

  const filteredCodes = useMemo(() => {
    if (!searchTerm) return naceCodesData;
    return naceCodesData.filter(code =>
      code.toLowerCase().includes(searchTerm.toLowerCase())
    );
  }, [searchTerm]);

  const isSelectable = (code: string) => {
    const indentLevel = getIndentLevel(code);
    // Only allow selection of level 2+ (3+ digit codes)
    return indentLevel >= 2;
  };

  const handleCodeToggle = (code: string) => {
    if (!isSelectable(code)) return;
    
    if (selectedValues.includes(code)) {
      onSelectionChange(selectedValues.filter(v => v !== code));
    } else {
      onSelectionChange([...selectedValues, code]);
    }
  };

  const getIndentLevel = (code: string) => {
    if (code.includes(" - ") && !code.includes(".")) {
      if (code.split(" - ")[0].length === 1) return 0; // Main sections
      return 1; // Sub-sections
    }
    if (code.includes(".")) {
      const parts = code.split(".");
      if (parts.length === 2 && parts[1].length <= 2) return 2; // Level 1 subsections
      return 3; // Level 2+ subsections
    }
    return 1;
  };

  const renderSelectedCodes = () => {
    if (selectedValues.length === 0) {
      return <span className="text-muted-foreground">Select NACE sector classification codes...</span>;
    }
    
    if (selectedValues.length <= 3) {
      return selectedValues.map((value, index) => (
        <Badge key={index} variant="secondary" className="mr-1 mb-1">
          {value.length > 50 ? `${value.substring(0, 50)}...` : value}
        </Badge>
      ));
    }
    
    return (
      <div className="flex flex-wrap gap-1">
        {selectedValues.slice(0, 2).map((value, index) => (
          <Badge key={index} variant="secondary">
            {value.length > 30 ? `${value.substring(0, 30)}...` : value}
          </Badge>
        ))}
        <Badge variant="outline">+{selectedValues.length - 2} more</Badge>
      </div>
    );
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button 
          variant="outline" 
          className="w-full h-auto min-h-[2.5rem] p-3 text-left justify-start"
          disabled={disabled}
        >
          {renderSelectedCodes()}
        </Button>
      </DialogTrigger>
      <DialogContent className="max-w-4xl h-[85vh] flex flex-col">
        <DialogHeader>
          <DialogTitle>Select NACE Sector Classification Codes</DialogTitle>
        </DialogHeader>
        
        <div className="flex items-center space-x-2 mb-4">
          <Search className="h-4 w-4 text-muted-foreground" />
          <Input
            placeholder="Search NACE codes..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="flex-1"
          />
        </div>

        <ScrollArea className="flex-1 overflow-auto pr-4">
          <div className="space-y-1">
            {filteredCodes.map((code) => {
              const indentLevel = getIndentLevel(code);
              const isSelected = selectedValues.includes(code);
              const canSelect = isSelectable(code);
              
              return (
                <div
                  key={code}
                  className={`flex items-center space-x-2 p-2 rounded ${
                    canSelect ? "hover:bg-accent cursor-pointer" : "cursor-not-allowed opacity-60"
                  } ${
                    isSelected ? "bg-accent" : ""
                  }`}
                  style={{ paddingLeft: `${8 + indentLevel * 16}px` }}
                  onClick={() => handleCodeToggle(code)}
                >
                  <div className={`w-4 h-4 border rounded ${
                    canSelect ? (
                      isSelected ? "bg-primary border-primary" : "border-input"
                    ) : "border-muted bg-muted"
                  } flex items-center justify-center`}>
                    {isSelected && canSelect && <Check className="h-3 w-3 text-primary-foreground" />}
                  </div>
                  <span className={`text-sm ${
                    indentLevel === 0 ? "font-semibold" : 
                    indentLevel === 1 ? "font-medium" : ""
                  } ${!canSelect ? "text-muted-foreground" : ""}`}>
                    {code}
                  </span>
                </div>
              );
            })}
          </div>
        </ScrollArea>

        <div className="flex justify-between items-center pt-4 border-t">
          <span className="text-sm text-muted-foreground">
            {selectedValues.length} selected
          </span>
          <div className="space-x-2">
            <Button 
              variant="outline" 
              onClick={() => onSelectionChange([])}
              disabled={selectedValues.length === 0}
            >
              Clear All
            </Button>
            <Button onClick={() => setOpen(false)}>
              Done
            </Button>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
};